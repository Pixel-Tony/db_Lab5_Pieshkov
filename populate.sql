TRUNCATE TABLE Pizzas_Ingredients, Orders_Pizzas, Pizzas, Orders, Ingredients, Categories;

INSERT INTO
    Categories (category_id, category_name)
VALUES
    (1, 'Veggie'),
    (2, 'Classic'),
    (3, 'Supreme'),
    (4, 'Chicken');

INSERT INTO
    Ingredients (ingredient_id, ingredient_name)
VALUES
    (1, 'Spinach'),
    (2, 'Mozzarella Cheese'),
    (3, 'Artichokes'),
    (4, 'Kalamata Olives'),
    (5, 'Feta Cheese'),
    (6, 'Sun-dried Tomatoes'),
    (7, 'Red Onions'),
    (8, 'Plum Tomatoes'),
    (9, 'Tomato Sauce'),
    (10, 'Sliced Ham'),
    (11, 'Pineapple'),
    (12, 'Tomatoes'),
    (13, 'Mushrooms'),
    (14, 'Green Olives'),
    (15, 'Garlic'),
    (16, 'Jalapeno Peppers'),
    (17, 'Corn'),
    (18, 'Chipotle Sauce'),
    (19, 'Red Peppers'),
    (20, 'Cilantro'),
    (21, 'Beef Chuck Roast'),
    (22, 'Nduja Salami'),
    (23, 'Pancetta'),
    (24, 'Friggitello Peppers'),
    (25, 'Chicken'),
    (26, 'Thai Sweet Chilli Sauce'),
    (27, 'Arugula'),
    (28, 'Prosciutto di San Daniele'),
    (29, 'Calabrese Salami'),
    (30, 'Capocollo'),
    (31, 'Pepperoni'),
    (32, 'Pesto Sauce'),
    (33, 'Coarse Sicilian Salami'),
    (34, 'Luganega Sausage'),
    (35, 'Onions'),
    (36, 'Zucchini'),
    (37, 'Eggplant'),
    (38, 'Anchovies'),
    (39, 'Green Peppers'),
    (40, 'Barbecue Sauce'),
    (41, 'Barbecued Chicken'),
    (42, 'Gouda Cheese'),
    (43, 'Fontina Cheese'),
    (44, 'Artichoke'),
    (45, 'Romano Cheese'),
    (46, 'Smoked Gouda Cheese'),
    (47, 'Provolone Cheese'),
    (48, 'Blue Cheese'),
    (49, 'Goat Cheese'),
    (50, 'Oregano');

INSERT INTO
    Pizzas (pizza_id, pizza_name, pizza_size, pizza_price, category_id)
VALUES
    ('mediterraneo_l', 'The Mediterranean Pizza', 'L', 20.25, 1),
    ('hawaiian_s', 'The Hawaiian Pizza', 'S', 10.5, 2),
    ('green_garden_m', 'The Green Garden Pizza', 'M', 16, 1),
    ('mexicana_l', 'The Mexicana Pizza', 'L', 20.25, 1),
    ('the_greek_xl', 'The Greek Pizza', 'XL', 25.5, 2),
    ('calabrese_m', 'The Calabrese Pizza', 'M', 16.25, 3),
    ('thai_ckn_l', 'The Thai Chicken Pizza', 'L', 20.75, 4),
    ('prsc_argla_l', 'The Prosciutto and Arugula Pizza', 'L', 20.75, 3),
    ('ital_supr_l', 'The Italian Supreme Pizza', 'L', 20.75, 3),
    ('pepperoni_s', 'The Pepperoni Pizza', 'S', 9.75, 2),
    ('ckn_pesto_m', 'The Chicken Pesto Pizza', 'M', 16.75, 4),
    ('green_garden_s', 'The Green Garden Pizza', 'S', 12, 1),
    ('sicilian_s', 'The Sicilian Pizza', 'S', 12.25, 3),
    ('calabrese_s', 'The Calabrese Pizza', 'S', 12.25, 3),
    ('ital_veggie_s', 'The Italian Vegetables Pizza', 'S', 12.75, 1),
    ('napolitana_s', 'The Napolitana Pizza', 'S', 12, 2),
    ('bbq_ckn_l', 'The Barbecue Chicken Pizza', 'L', 20.75, 4),
    ('cali_ckn_m', 'The California Chicken Pizza', 'M', 16.75, 4),
    ('five_cheese_l', 'The Five Cheese Pizza', 'L', 18.5, 1),
    ('cali_ckn_l', 'The California Chicken Pizza', 'L', 20.75, 4),
    ('ital_cpcllo_l', 'The Italian Capocollo Pizza', 'L', 20.5, 2);

INSERT INTO
    Orders (order_id, accepted_at, total_price)
VALUES
    (1, '21.01.2015 17:56:32', 0),
    (2, '11.02.2015 20:33:15', 0),
    (3, '14.02.2015 21:58:09', 0),
    (4, '21.02.2015 18:11:42', 0),
    (5, '27.03.2015 14:33:30', 0),
    (6, '26.04.2015 19:20:07', 0),
    (7, '04.07.2015 21:26:10', 0),
    (8, '23.10.2015 21:30:41', 0),
    (9, '28.10.2015 13:01:51', 0),
    (10, '26.11.2015 14:55:20', 0),
    (11, '14.12.2015 16:53:47', 0),
    (12, '14.12.2015 22:21:50', 0);

INSERT INTO
    Orders_Pizzas (order_id, pizza_id, quantity)
VALUES
    (1, 'mediterraneo_l', 1),
    (2, 'hawaiian_s', 1),
    (3, 'green_garden_m', 1),
    (3, 'mexicana_l', 1),
    (3, 'the_greek_xl', 1),
    (4, 'calabrese_m', 1),
    (4, 'thai_ckn_l', 1),
    (5, 'prsc_argla_l', 1),
    (6, 'ital_supr_l', 1),
    (6, 'pepperoni_s', 1),
    (7, 'ckn_pesto_m', 1),
    (7, 'green_garden_s', 1),
    (7, 'hawaiian_s', 1),
    (8, 'sicilian_s', 1),
    (9, 'calabrese_s', 1),
    (10, 'ital_veggie_s', 1),
    (10, 'mexicana_l', 1),
    (10, 'napolitana_s', 1),
    (11, 'bbq_ckn_l', 1),
    (11, 'calabrese_m', 1),
    (11, 'cali_ckn_m', 1),
    (11, 'five_cheese_l', 1),
    (12, 'cali_ckn_l', 1),
    (12, 'ital_cpcllo_l', 1);

INSERT INTO
    Pizzas_Ingredients (pizza_id, ingredient_id)
VALUES
    ('mediterraneo_l', 1),
    ('mediterraneo_l', 2),
    ('mediterraneo_l', 3),
    ('mediterraneo_l', 4),
    ('mediterraneo_l', 5),
    ('mediterraneo_l', 6),
    ('mediterraneo_l', 7),
    ('mediterraneo_l', 8),
    ('mediterraneo_l', 9),
    ('hawaiian_s', 2),
    ('hawaiian_s', 10),
    ('hawaiian_s', 11),
    ('hawaiian_s', 9),
    ('green_garden_m', 2),
    ('green_garden_m', 12),
    ('green_garden_m', 13),
    ('green_garden_m', 14),
    ('green_garden_m', 5),
    ('green_garden_m', 1),
    ('green_garden_m', 9),
    ('mexicana_l', 12),
    ('mexicana_l', 15),
    ('mexicana_l', 16),
    ('mexicana_l', 2),
    ('mexicana_l', 17),
    ('mexicana_l', 18),
    ('mexicana_l', 19),
    ('mexicana_l', 7),
    ('mexicana_l', 20),
    ('the_greek_xl', 2),
    ('the_greek_xl', 12),
    ('the_greek_xl', 15),
    ('the_greek_xl', 4),
    ('the_greek_xl', 5),
    ('the_greek_xl', 7),
    ('the_greek_xl', 21),
    ('the_greek_xl', 9),
    ('calabrese_m', 2),
    ('calabrese_m', 22),
    ('calabrese_m', 12),
    ('calabrese_m', 15),
    ('calabrese_m', 23),
    ('calabrese_m', 7),
    ('calabrese_m', 24),
    ('calabrese_m', 9),
    ('thai_ckn_l', 2),
    ('thai_ckn_l', 12),
    ('thai_ckn_l', 25),
    ('thai_ckn_l', 19),
    ('thai_ckn_l', 11),
    ('thai_ckn_l', 26),
    ('prsc_argla_l', 2),
    ('prsc_argla_l', 27),
    ('prsc_argla_l', 28),
    ('prsc_argla_l', 9),
    ('ital_supr_l', 2),
    ('ital_supr_l', 12),
    ('ital_supr_l', 15),
    ('ital_supr_l', 29),
    ('ital_supr_l', 30),
    ('ital_supr_l', 7),
    ('ital_supr_l', 14),
    ('ital_supr_l', 9),
    ('pepperoni_s', 2),
    ('pepperoni_s', 31),
    ('pepperoni_s', 9),
    ('ckn_pesto_m', 2),
    ('ckn_pesto_m', 12),
    ('ckn_pesto_m', 15),
    ('ckn_pesto_m', 32),
    ('ckn_pesto_m', 25),
    ('ckn_pesto_m', 19),
    ('ckn_pesto_m', 1),
    ('green_garden_s', 2),
    ('green_garden_s', 12),
    ('green_garden_s', 13),
    ('green_garden_s', 14),
    ('green_garden_s', 5),
    ('green_garden_s', 1),
    ('green_garden_s', 9),
    ('sicilian_s', 2),
    ('sicilian_s', 33),
    ('sicilian_s', 12),
    ('sicilian_s', 15),
    ('sicilian_s', 34),
    ('sicilian_s', 35),
    ('sicilian_s', 14),
    ('sicilian_s', 9),
    ('calabrese_s', 2),
    ('calabrese_s', 22),
    ('calabrese_s', 12),
    ('calabrese_s', 15),
    ('calabrese_s', 23),
    ('calabrese_s', 7),
    ('calabrese_s', 24),
    ('calabrese_s', 9),
    ('ital_veggie_s', 2),
    ('ital_veggie_s', 12),
    ('ital_veggie_s', 15),
    ('ital_veggie_s', 3),
    ('ital_veggie_s', 32),
    ('ital_veggie_s', 36),
    ('ital_veggie_s', 19),
    ('ital_veggie_s', 37),
    ('napolitana_s', 2),
    ('napolitana_s', 12),
    ('napolitana_s', 15),
    ('napolitana_s', 38),
    ('napolitana_s', 7),
    ('napolitana_s', 14),
    ('napolitana_s', 9),
    ('bbq_ckn_l', 2),
    ('bbq_ckn_l', 39),
    ('bbq_ckn_l', 12),
    ('bbq_ckn_l', 40),
    ('bbq_ckn_l', 19),
    ('bbq_ckn_l', 7),
    ('bbq_ckn_l', 41),
    ('cali_ckn_m', 1),
    ('cali_ckn_m', 2),
    ('cali_ckn_m', 15),
    ('cali_ckn_m', 16),
    ('cali_ckn_m', 42),
    ('cali_ckn_m', 25),
    ('cali_ckn_m', 43),
    ('cali_ckn_m', 44),
    ('cali_ckn_m', 9),
    ('five_cheese_l', 2),
    ('five_cheese_l', 15),
    ('five_cheese_l', 45),
    ('five_cheese_l', 46),
    ('five_cheese_l', 47),
    ('five_cheese_l', 48),
    ('five_cheese_l', 9),
    ('cali_ckn_l', 1),
    ('cali_ckn_l', 2),
    ('cali_ckn_l', 15),
    ('cali_ckn_l', 16),
    ('cali_ckn_l', 42),
    ('cali_ckn_l', 25),
    ('cali_ckn_l', 43),
    ('cali_ckn_l', 44),
    ('cali_ckn_l', 9),
    ('ital_cpcllo_l', 2),
    ('ital_cpcllo_l', 12),
    ('ital_cpcllo_l', 15),
    ('ital_cpcllo_l', 30),
    ('ital_cpcllo_l', 19),
    ('ital_cpcllo_l', 49),
    ('ital_cpcllo_l', 50),
    ('ital_cpcllo_l', 9);

UPDATE orders
SET
    total_price = sub.total_price
FROM
    (
        SELECT
            order_id,
            SUM(pizzas.pizza_price * orders_pizzas.quantity) AS total_price
        FROM
            orders
            NATURAL JOIN orders_pizzas
            NATURAL JOIN pizzas
        GROUP BY
            order_id
    ) AS sub
WHERE
    orders.order_id = sub.order_id;
